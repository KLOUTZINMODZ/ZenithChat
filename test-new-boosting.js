/**
 * Teste espec√≠fico para o tipo 'new_boosting' que n√£o est√° funcionando
 */

const axios = require('axios');

const CHAT_API_URL = 'https://12zku8.instatunnel.my/';
const USER_ID = '6897d82c8cdd40188e08a224';

async function testNewBoosting() {
  console.log('üéØ Teste espec√≠fico para new_boosting...');

  // Teste 1: new_boosting simples
  console.log('\nüß™ TESTE 1: new_boosting b√°sico');
  try {
    await axios.post(`${CHAT_API_URL}/api/notifications/send`, {
      userIds: [USER_ID],
      notification: {
        id: `simple_boosting_${Date.now()}`,
        title: 'TESTE: Novo Boosting Simples',
        message: 'Este √© um teste b√°sico de new_boosting',
        type: 'new_boosting',
        timestamp: new Date().toISOString(),
        isRead: false
      }
    });
    console.log('‚úÖ Enviado: new_boosting simples');
  } catch (error) {
    console.error('‚ùå Erro:', error.message);
  }

  await new Promise(resolve => setTimeout(resolve, 3000));

  // Teste 2: new_boosting com campos extras (formato original)
  console.log('\nüß™ TESTE 2: new_boosting formato completo');
  try {
    await axios.post(`${CHAT_API_URL}/api/notifications/send`, {
      userIds: [USER_ID],
      notification: {
        id: `full_boosting_${Date.now()}`,
        title: 'TESTE: Novo Boosting Completo',
        message: 'Novo pedido de boosting para **Counter-Strike** foi publicado: Prata ‚Üí Ouro por R$ 80,00',
        type: 'new_boosting',
        link: '/boosting/789/proposals',
        image: 'https://via.placeholder.com/40',
        timestamp: new Date().toISOString(),
        isRead: false,
        relatedId: 'test_789',
        relatedType: 'BoostingRequest'
      }
    });
    console.log('‚úÖ Enviado: new_boosting completo');
  } catch (error) {
    console.error('‚ùå Erro:', error.message);
  }

  await new Promise(resolve => setTimeout(resolve, 3000));

  // Teste 3: Compara√ß√£o com tipo que funciona
  console.log('\n‚úÖ TESTE 3: new_proposal (que funciona)');
  try {
    await axios.post(`${CHAT_API_URL}/api/notifications/send`, {
      userIds: [USER_ID],
      notification: {
        id: `working_proposal_${Date.now()}`,
        title: 'TESTE: Nova Proposta (Controle)',
        message: 'Esta deveria funcionar normalmente',
        type: 'new_proposal',
        timestamp: new Date().toISOString(),
        isRead: false
      }
    });
    console.log('‚úÖ Enviado: new_proposal (controle)');
  } catch (error) {
    console.error('‚ùå Erro:', error.message);
  }

  console.log('\nüìä RESULTADO ESPERADO:');
  console.log('- TESTE 1 e 2 (new_boosting): devem aparecer se n√£o h√° problema espec√≠fico');
  console.log('- TESTE 3 (new_proposal): deve aparecer como controle');
  console.log('\nüîç Se new_boosting ainda n√£o aparecer:');
  console.log('- Problema pode estar no processamento frontend do tipo new_boosting');
  console.log('- Ou filtro espec√≠fico no backend para esse tipo');
}

testNewBoosting().catch(console.error);
